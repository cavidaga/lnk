<!DOCTYPE html>
<html lang="az" class="no-js">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="noindex, nofollow" />

  <title>LNK.az Developer Paneli</title>
  <meta name="description" content="LNK.az Developer Paneli - API test v…ô idar…ôetm…ô interfeysi" />
  <meta name="theme-color" content="#0c0d12">
  <meta name="color-scheme" content="light dark" />
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link rel="icon" href="/static/favicon.svg" type="image/svg+xml">
  <link rel="alternate icon" href="/static/favicon.ico">
  <link rel="icon" href="/static/favicon-light.svg" media="(prefers-color-scheme: light)">
  <link rel="icon" href="/static/favicon-dark.svg"  media="(prefers-color-scheme: dark)">
  <link rel="apple-touch-icon" href="/static/apple-touch-icon.png">

  <link rel="stylesheet" href="/static/styles.css">
  
  <style>
    /* Admin-specific styles that extend the main design system */
    .admin-header {
      text-align: center;
      margin-bottom: 2rem;
      padding: 2rem;
      background: linear-gradient(135deg, var(--danger) 0%, #c82333 100%);
      color: white;
      border-radius: 12px;
    }
    
    .admin-header h1 {
      font-size: 1.8rem;
      margin-bottom: 0.5rem;
      font-weight: 700;
    }
    
    .admin-header p {
      font-size: 1.2rem;
      opacity: 0.9;
    }
    
    .admin-section {
      margin-bottom: 2rem;
    }
    
    .admin-section h2 {
      background: var(--panel);
      padding: 1.5rem;
      margin: 0 0 0 0;
      border-bottom: 1px solid var(--border);
      color: var(--text);
      font-size: 1.5rem;
      border-radius: 12px 12px 0 0;
    }
    
    .admin-content {
      padding: 1.5rem;
      background: var(--card);
      border-radius: 0 0 12px 12px;
      border: 1px solid var(--border);
      border-top: none;
    }
    
    .user-info {
      background: var(--panel);
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      border: 1px solid var(--border);
    }
    
    .user-info h3 {
      margin: 0 0 0.5rem 0;
      color: var(--text);
    }
    
    .user-info p {
      margin: 0.25rem 0;
      color: var(--muted);
    }
    
    .hidden {
      display: none;
    }
    
    .status-indicator {
      display: inline-block;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      margin-right: 0.5rem;
    }
    
    .status-online {
      background: #28a745;
    }
    
    .status-offline {
      background: var(--danger);
    }
    
    .button-group {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      margin-bottom: 1rem;
    }
    
    /* Button variants - extending main design system */
    .btn-primary {
      background: linear-gradient(135deg,
                   color-mix(in oklab, var(--accent) 90%, white 10%),
                   color-mix(in oklab, var(--accent-2) 78%, black 22%));
      color: #fff;
      border: 0;
      font-weight: 650;
    }
    
    .btn-primary:hover {
      transform: translateY(-1px);
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
    }
    
    .btn-danger {
      background: linear-gradient(135deg, var(--danger), #c82333);
      color: white;
      border: 0;
      font-weight: 650;
    }
    
    .btn-danger:hover {
      transform: translateY(-1px);
      background: linear-gradient(135deg, #c82333, #a01e2a);
    }
    
    .btn-success {
      background: linear-gradient(135deg, #28a745, #218838);
      color: white;
      border: 0;
      font-weight: 650;
    }
    
    .btn-success:hover {
      transform: translateY(-1px);
      background: linear-gradient(135deg, #218838, #1e7e34);
    }
    
    .btn-secondary {
      background: var(--panel);
      color: var(--text);
      border: 1px solid var(--border);
      font-weight: 500;
    }
    
    .btn-secondary:hover {
      transform: translateY(-1px);
      background: var(--card);
      border-color: var(--accent);
    }
    
    .btn:disabled {
      background: var(--border);
      cursor: not-allowed;
      transform: none;
      color: var(--muted);
      opacity: 0.6;
    }
    
    .alert {
      padding: 1rem;
      margin-bottom: 1rem;
      border-radius: 8px;
      border: 1px solid transparent;
    }
    
    .alert-success {
      background: color-mix(in oklab, #28a745 10%, var(--panel) 90%);
      border-color: #28a745;
      color: #155724;
    }
    
    .alert-danger {
      background: color-mix(in oklab, var(--danger) 10%, var(--panel) 90%);
      border-color: var(--danger);
      color: #721c24;
    }
    
    .alert-info {
      background: color-mix(in oklab, #007bff 10%, var(--panel) 90%);
      border-color: #007bff;
      color: #0c5460;
    }
    
    .form-group {
      margin-bottom: 1rem;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: var(--text);
    }
    
    .form-group input,
    .form-group select {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid var(--border);
      border-radius: 6px;
      font-size: 1rem;
      box-sizing: border-box;
      background: var(--panel);
      color: var(--text);
    }
    
    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(255, 0, 0, 0.25);
    }
    
    .form-group small {
      color: var(--muted);
      font-size: 0.875rem;
      margin-top: 0.25rem;
      display: block;
    }
    
    .form-row {
      display: flex;
      gap: 1rem;
    }
    
    .form-row .form-group {
      flex: 1;
    }
    
    .api-key-item {
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
      background: var(--card);
    }
    
    .api-key-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    
    .api-key-header h5 {
      margin: 0;
      flex: 1;
      color: var(--text);
    }
    
    .api-key-details {
      margin: 0.25rem 0;
      color: var(--muted);
      font-size: 0.9rem;
    }
    
    .api-key-details strong {
      color: var(--text);
    }

    /* Tooltip styles */
    .radial-item {
      position: relative;
      cursor: pointer;
    }

    .radial-item::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: var(--panel);
      color: var(--text);
      padding: 0.5rem 0.75rem;
      border-radius: 4px;
      font-size: 0.875rem;
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s, visibility 0.2s;
      z-index: 1000;
      border: 1px solid var(--border);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      margin-bottom: 0.5rem;
    }

    .radial-item::before {
      content: '';
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 4px solid transparent;
      border-top-color: var(--panel);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s, visibility 0.2s;
      z-index: 1000;
      margin-bottom: -4px;
    }

    .radial-item:hover::after,
    .radial-item:hover::before {
      opacity: 1;
      visibility: visible;
    }
    
    .test-result {
      margin-top: 1rem;
      padding: 1rem;
      background: var(--panel);
      border-radius: 8px;
      border: 1px solid var(--border);
    }
    
    .test-result h4 {
      margin-bottom: 0.5rem;
      color: var(--text);
    }
    
    .test-result pre {
      background: var(--bg);
      padding: 1rem;
      border-radius: 6px;
      overflow-x: auto;
      font-size: 0.9rem;
      border: 1px solid var(--border);
      margin: 0;
    }
    
    .test-result pre.success {
      border-left: 4px solid #28a745;
    }
    
    .test-result pre.error {
      border-left: 4px solid var(--danger);
    }
    
    /* Beautiful UI Components */
    .plans-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .plan-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
      transition: all 0.2s ease;
      position: relative;
      overflow: hidden;
    }
    
    .plan-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
    }
    
    .plan-card.featured {
      border-color: var(--accent);
      background: color-mix(in oklab, var(--accent) 5%, var(--card) 95%);
    }
    
    .plan-card.coming-soon {
      opacity: 0.7;
      position: relative;
    }
    
    .plan-card.coming-soon::after {
      content: 'Coming Soon';
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: var(--warning-color);
      color: var(--warning-text);
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 600;
    }
    
    .plan-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1rem;
    }
    
    .plan-name {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text);
      margin: 0;
    }
    
    .plan-price {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--accent);
    }
    
    .plan-price.free {
      color: var(--muted);
    }
    
    .plan-description {
      color: var(--muted);
      font-size: 0.9rem;
      margin-bottom: 1rem;
      line-height: 1.4;
    }
    
    .plan-features {
      list-style: none;
      padding: 0;
      margin: 0 0 1rem 0;
    }
    
    .plan-features li {
      padding: 0.25rem 0;
      color: var(--text);
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .plan-features li::before {
      content: '‚úì';
      color: var(--accent);
      font-weight: bold;
      width: 16px;
      text-align: center;
    }
    
    .plan-limits {
      background: var(--panel);
      border-radius: 8px;
      padding: 1rem;
      margin-top: 1rem;
    }
    
    .plan-limits h4 {
      margin: 0 0 0.5rem 0;
      font-size: 0.9rem;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .limit-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.25rem 0;
      font-size: 0.9rem;
    }
    
    .limit-value {
      font-weight: 600;
      color: var(--text);
    }
    
    .limit-value.unlimited {
      color: var(--accent);
    }
    
    /* Usage UI Components */
    .usage-dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .usage-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
      text-align: center;
    }
    
    .usage-card h4 {
      margin: 0 0 0.5rem 0;
      font-size: 0.9rem;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .usage-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--accent);
      margin: 0.5rem 0;
    }
    
    .usage-label {
      color: var(--text);
      font-size: 0.9rem;
    }
    
    .progress-bar {
      width: 100%;
      height: 8px;
      background: var(--panel);
      border-radius: 4px;
      overflow: hidden;
      margin: 0.5rem 0;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      border-radius: 4px;
      transition: width 0.3s ease;
    }
    
    .progress-fill.warning {
      background: linear-gradient(90deg, var(--warning-color), #ff9800);
    }
    
    .progress-fill.danger {
      background: linear-gradient(90deg, var(--danger), #c82333);
    }
    
    .usage-history {
      margin-top: 1rem;
    }
    
    .history-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem;
      background: var(--panel);
      border-radius: 8px;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }
    
    .history-endpoint {
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
      color: var(--text);
      flex: 1;
    }
    
    .history-cost {
      color: var(--accent);
      font-weight: 600;
      margin-left: 1rem;
    }
    
    .history-success {
      color: #28a745;
      margin-left: 0.5rem;
    }
    
    .history-failed {
      color: var(--danger);
      margin-left: 0.5rem;
    }
    
    /* Limits UI */
    .limits-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .limit-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
    }
    
    .limit-card h4 {
      margin: 0 0 1rem 0;
      color: var(--text);
      font-size: 1.1rem;
    }
    
    .limit-status {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }
    
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--accent);
    }
    
    .status-dot.warning {
      background: var(--warning-color);
    }
    
    .status-dot.danger {
      background: var(--danger);
    }
    
    .limit-text {
      color: var(--text);
      font-size: 0.9rem;
    }
    
    .limit-usage {
      font-weight: 600;
      color: var(--accent);
    }
    
    /* Subscription UI */
    .subscription-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
      margin-top: 1rem;
    }
    
    .subscription-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1rem;
    }
    
    .subscription-plan {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text);
      margin: 0;
    }
    
    .subscription-status {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .subscription-status.active {
      background: color-mix(in oklab, #28a745 20%, var(--panel) 80%);
      color: #155724;
    }
    
    .subscription-status.canceled {
      background: color-mix(in oklab, var(--danger) 20%, var(--panel) 80%);
      color: #721c24;
    }
    
    .subscription-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 1rem;
    }
    
    .subscription-detail {
      text-align: center;
    }
    
    .subscription-detail h5 {
      margin: 0 0 0.25rem 0;
      font-size: 0.8rem;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    .subscription-detail p {
      margin: 0;
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text);
    }
    
    /* Empty states */
    .empty-state {
      text-align: center;
      padding: 2rem;
      color: var(--muted);
    }
    
    .empty-state h4 {
      margin: 0 0 0.5rem 0;
      color: var(--text);
    }
    
    .empty-state p {
      margin: 0;
      font-size: 0.9rem;
    }
    
    /* Grid layouts for better organization */
    .api-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin-top: 1rem;
    }
    
    .api-subsection {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1.5rem;
    }
    
    .api-subsection h3 {
      margin: 0 0 1rem 0;
      color: var(--text);
      font-size: 1.2rem;
      border-bottom: 1px solid var(--border);
      padding-bottom: 0.5rem;
    }
    
    .usage-billing-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin-top: 1rem;
    }
    
    .usage-subsection,
    .billing-subsection {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1.5rem;
    }
    
    .usage-subsection h3,
    .billing-subsection h3 {
      margin: 0 0 1rem 0;
      color: var(--text);
      font-size: 1.2rem;
      border-bottom: 1px solid var(--border);
      padding-bottom: 0.5rem;
    }

    /* Responsive adjustments */
    @media (max-width: 1024px) {
      .api-grid,
      .usage-billing-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
    }
    
    @media (max-width: 768px) {
      .plans-grid {
        grid-template-columns: 1fr;
      }
      
      .usage-dashboard {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .limits-grid {
        grid-template-columns: 1fr;
      }
      
      .subscription-details {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div id="site-header"></div>
    <main id="main" role="main">
      <div class="admin-panel">
        <div class="admin-header">
          <h1>üîß LNK.az Developer Paneli</h1>
          <p>API test v…ô idar…ôetm…ô interfeysi</p>
        </div>

        <!-- User Status -->
        <div class="admin-section">
          <h2>M√∂vcud istifad…ô√ßi statusu</h2>
          <div class="admin-content">
            <div id="user-status">
              <div class="status-indicator status-offline"></div>
              <span>Hesaba daxil olunmayƒ±b</span>
            </div>
            <div id="user-info" class="user-info hidden">
              <h3 id="user-name">ƒ∞stifad…ô√ßi adƒ±</h3>
              <p id="user-email">user@example.com</p>
              <p id="user-plan">Plan: pulsuz</p>
            </div>
            <div style="margin-top: 1rem;">
              <button id="logout-btn" class="btn btn-danger hidden">√áƒ±xƒ±≈ü</button>
            </div>
          </div>
        </div>

        <!-- Login Form -->
        <div class="admin-section" id="login-section">
          <h2>Daxil ol</h2>
          <div class="admin-content">
            <form id="login-form">
              <div class="form-group">
                <label for="login-email">E-po√ßt</label>
                <input type="email" id="login-email" required>
              </div>
              <div class="form-group">
                <label for="login-password">≈ûifr…ô</label>
                <input type="password" id="login-password" required>
              </div>
              <button type="submit" class="btn btn-primary">Daxil ol</button>
            </form>
          </div>
        </div>

        <!-- Registration Form -->
        <div class="admin-section" id="register-section">
          <h2>Yeni istifad…ô√ßi qeydiyyatƒ±</h2>
          <div class="admin-content">
            <form id="register-form">
              <div class="form-group">
                <label for="register-email">E-po√ßt</label>
                <input type="email" id="register-email" required>
              </div>
              <div class="form-group">
                <label for="register-password">≈ûifr…ô</label>
                <input type="password" id="register-password" minlength="8" required>
              </div>
              <div class="form-group">
                <label for="register-token">Admin qeydiyyat tokeni</label>
                <input type="password" id="register-token" required>
              </div>
              <button type="submit" class="btn btn-success">Qeydiyyatdan ke√ß</button>
            </form>
          </div>
        </div>

        <!-- API Management & Testing -->
        <div class="admin-section" id="api-section">
          <h2>API idar…ôetm…ôsi v…ô sƒ±naƒüƒ±</h2>
          <div class="admin-content">
            <div class="api-grid">
              <!-- API Key Management -->
              <div class="api-subsection">
                <h3>API a√ßarlarƒ±nƒ±n idar…ô edilm…ôsi</h3>
                <div class="button-group">
                  <a id="create-key-btn" class="radial-item" data-tooltip="Yeni API a√ßarƒ± yarat" aria-label="Yeni API a√ßarƒ± yarat" href="#" onclick="event.preventDefault()">
                    <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
                      <path d="M512 512m-448 0a448 448 0 1 0 896 0 448 448 0 1 0-896 0Z" fill="#4CAF50" />
                      <path d="M448 298.666667h128v426.666666h-128z" fill="#FFFFFF" />
                      <path d="M298.666667 448h426.666666v128H298.666667z" fill="#FFFFFF" />
                    </svg>
                  </a>
                  <a id="refresh-keys-btn" class="radial-item" data-tooltip="Siyahƒ±nƒ± yenil…ô" aria-label="Siyahƒ±nƒ± yenil…ô" href="#" onclick="event.preventDefault()">
                    <svg class="icon" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                       viewBox="0 0 496.156 496.156" xml:space="preserve">
                      <path style="fill:#32BEA6;" d="M0,248.08C0,111.06,111.069,0.002,248.074,0.002c137.013,0,248.082,111.059,248.082,248.078
                        c0,137.005-111.069,248.074-248.082,248.074C111.069,496.154,0,385.085,0,248.08z"/>
                      <g>
                        <path style="fill:#FFFFFF;" d="M428.243,172.149c-10.348,0.023-20.694,0.054-31.042,0.077
                          c-23.272-52.177-68.95-89.871-126.649-98.91c-64.287-10.071-125.816,19.788-162.504,72.312
                          c-16.296,23.326,22.003,45.165,38.16,22.034c50.317-72.037,157.757-65.527,201.907,4.686c-9.559,0.022-19.118,0.046-28.678,0.068
                          c-2.674,0.008-4.574,1.197-5.749,2.877c-1.92,2.058-2.65,5.072-0.639,8.186c18.204,28.25,36.408,56.499,54.616,84.745
                          c3.061,4.747,9.663,4.708,12.696-0.046c18.062-28.338,36.126-56.675,54.188-85.013C437.538,178.48,433.602,172.135,428.243,172.149
                          z"/>
                        <path style="fill:#FFFFFF;" d="M350.353,327.224c-49.927,71.49-156.108,65.63-200.886-3.049c9.161-0.022,18.322-0.046,27.484-0.068
                          c2.666-0.008,4.563-1.19,5.741-2.865c1.924-2.059,2.658-5.072,0.646-8.197c-18.2-28.246-36.405-56.499-54.609-84.741
                          c-3.056-4.751-9.662-4.712-12.695,0.046c-18.063,28.334-36.13,56.671-54.196,85.009c-2.987,4.689,0.948,11.032,6.308,11.017
                          c10.669-0.027,21.337-0.054,32.006-0.08c23.498,51.319,68.777,88.332,125.865,97.275c64.287,10.072,125.816-19.784,162.496-72.312
                          C404.806,325.928,366.508,304.09,350.353,327.224z"/>
                      </g>
                    </svg>
                  </a>
                </div>

                <div id="create-key-form" class="hidden" style="background: var(--panel); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; border: 1px solid var(--border);">
                  <h4>Yeni API a√ßarƒ± yarat</h4>
                  <div class="form-group">
                    <label for="key-name">A√ßarƒ±n adƒ±</label>
                    <input type="text" id="key-name" placeholder="API a√ßarƒ±m">
                  </div>
                  <div class="form-group">
                    <label for="key-permissions">ƒ∞caz…ôl…ôr (verg√ºll…ô ayƒ±rƒ±n)</label>
                    <input type="text" id="key-permissions" placeholder="analyze,get-analysis" value="analyze,get-analysis">
                    <small>M√∂vcud icaz…ôl…ôr: analyze, get-analysis, statistics, site-averages, recent-analyses, usage, billing</small>
                  </div>
                  <div class="button-group">
                    <a id="submit-key-btn" class="radial-item" data-tooltip="A√ßar yarat" aria-label="A√ßar yarat" href="#" onclick="event.preventDefault()">
                      <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
                        <path d="M512 512m-448 0a448 448 0 1 0 896 0 448 448 0 1 0-896 0Z" fill="currentColor"/>
                        <path d="M448 298.666667h128v426.666666h-128z" fill="#FFFFFF"/>
                        <path d="M298.666667 448h426.666666v128H298.666667z" fill="#FFFFFF"/>
                      </svg>
                    </a>
                    <a id="cancel-key-btn" class="radial-item" data-tooltip="L…ôƒüv et" aria-label="L…ôƒüv et" href="#" onclick="event.preventDefault()">
                      <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                        <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                      </svg>
                    </a>
                  </div>
                </div>

                <div id="api-keys-list">
                  <h4>API a√ßarlarƒ±nƒ±z</h4>
                  <div id="keys-container">
                    <p>Y√ºkl…ônir...</p>
                  </div>
                </div>
              </div>

              <!-- API Testing -->
              <div class="api-subsection">
                <h3>API sƒ±naƒüƒ±</h3>
                <div class="form-group">
                  <label for="test-url">Test URL-i</label>
                  <div style="display: flex; gap: 0.5rem; align-items: center;">
                    <input type="url" id="test-url" placeholder="https://example.com/news-article" style="flex: 1;">
                    <a id="test-analyze-btn" class="radial-item" data-tooltip="T…ôhlili sƒ±na" aria-label="T…ôhlili sƒ±na" href="#" onclick="event.preventDefault()">
                      <svg class="icon" viewBox="0 0 392.533 392.533" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
                        <polygon style="fill:#56ACE0;" points="39.876,348.962 28.757,370.747 363.754,370.747 352.635,348.962 "/>
                        <g>
                          <path style="fill:#FFC10D;" d="M207.181,32.711c0-6.012-4.848-10.925-10.925-10.925s-10.925,4.848-10.925,10.925v65.422h21.786
                            V32.711H207.181z"/>
                          <rect x="185.33" y="163.556" style="fill:#FFC10D;" width="21.786" height="163.491"/>
                          <rect x="130.122" y="119.984" style="fill:#FFC10D;" width="132.202" height="21.786"/>
                        </g>
                        <path style="fill:#FFFFFF;" d="M108.336,58.893H42.914v15.192h32.711c6.012,0,10.925,4.848,10.925,10.925
                          c0,6.012-4.848,10.925-10.925,10.925H42.914v21.786h10.925c6.012,0,10.925,4.848,10.925,10.925c0,6.012-4.848,10.925-10.925,10.925
                          H42.914v54.562h65.422V58.893L108.336,58.893z"/>
                        <path style="fill:#56ACE0;" d="M42.914,243.782c0,18.036,14.675,32.711,32.711,32.711s32.711-14.675,32.711-32.711v-27.927H42.914
                          V243.782z"/>
                        <path style="fill:#FFC10D;" d="M316.886,276.493c18.036,0,32.711-14.675,32.711-32.711v-27.927H284.11v27.927
                          C284.175,261.818,298.785,276.493,316.886,276.493z"/>
                        <rect x="284.175" y="58.893" style="fill:#FFFFFF;" width="65.422" height="135.176"/>
                        <path style="fill:#194F82;" d="M391.359,376.695l-22.303-43.636c-1.875-3.62-5.624-5.947-9.762-5.947H228.967V163.556h33.358v80.226
                          c0,30.061,24.501,54.562,54.562,54.562c30.061,0,54.562-24.501,54.562-54.562V58.893c5.689-0.388,10.214-5.042,10.214-10.796
                          c0-6.012-4.848-10.925-10.925-10.925H263.035c-6.012,0-10.925,4.848-10.925,10.925c0,5.818,4.59,10.537,10.214,10.796v39.24h-33.358
                          V32.711C228.967,14.675,214.292,0,196.255,0s-32.711,14.675-32.711,32.711v65.422h-33.358v-39.24
                          c5.689-0.388,10.214-5.042,10.214-10.796c0-6.012-4.848-10.925-10.925-10.925H21.775c-6.012,0-10.925,4.848-10.925,10.925
                          c0,5.818,4.59,10.537,10.214,10.796v184.889c0,30.061,24.501,54.562,54.562,54.562s54.562-24.501,54.562-54.562v-80.226h33.358
                          v163.556H33.152c-4.073,0-7.887,2.327-9.762,5.947L1.152,376.695c-3.297,6.659,0.905,15.386,9.762,15.838h370.747
                          C390.195,392.533,394.785,383.806,391.359,376.695z M284.175,58.893h65.422v135.176h-65.422V58.893z M284.175,215.919h65.422v27.927
                          c0,18.036-14.675,32.711-32.711,32.711c-18.036,0-32.711-14.675-32.711-32.711V215.919L284.175,215.919z M108.336,243.782
                          c0,18.036-14.675,32.711-32.711,32.711s-32.711-14.675-32.711-32.711v-27.927h65.422V243.782L108.336,243.782L108.336,243.782z
                           M108.336,194.004H42.914v-54.562h10.925c6.012,0,10.925-4.848,10.925-10.925c0-6.012-4.848-10.925-10.925-10.925H42.914V95.806
                          h32.711c6.012,0,10.925-4.848,10.925-10.925c0-6.012-4.848-10.925-10.925-10.925H42.914V58.764h65.422v135.176l0,0V194.004z
                           M185.33,32.711c0-6.012,4.848-10.925,10.925-10.925c6.012,0,10.925,4.848,10.925,10.925v65.422h-21.786L185.33,32.711
                          L185.33,32.711z M130.187,141.705v-21.786h132.202v21.786H130.187z M207.181,163.556v163.491h-21.786V163.556H207.181z
                           M28.757,370.747l11.119-21.786h312.889l11.119,21.786H28.757z"/>
                      </svg>
                    </a>
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <label for="test-model">Model n√∂v√º</label>
                    <select id="test-model">
                      <option value="auto">Auto</option>
                      <option value="flash-lite">Flash Lite</option>
                      <option value="flash">Flash</option>
                      <option value="pro">Pro</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label for="test-api-key">API a√ßarƒ± (ist…ôy…ô g√∂r…ô)</label>
                    <input type="password" id="test-api-key" placeholder="lnk_... (sesiyanƒ± istifad…ô etm…ôk √º√ß√ºn bo≈ü saxlayƒ±n)">
                  </div>
                </div>
                <div id="test-result" class="test-result hidden">
                  <h4>T…ôhlil N…ôtic…ôsi:</h4>
                  <pre id="test-result-content"></pre>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Usage & Billing Management -->
        <div class="admin-section" id="usage-billing-section">
          <h2>ƒ∞stifad…ô v…ô √∂d…ôni≈ü idar…ôetm…ôsi</h2>
          <div class="admin-content">
            <div class="usage-billing-grid">
              <!-- Usage Tracking -->
              <div class="usage-subsection">
                <h3>ƒ∞stifad…ônin izl…ônm…ôsi</h3>
                <div class="form-group">
                  <label for="usage-period">D√∂vr</label>
                  <select id="usage-period">
                    <option value="day">Bu g√ºn</option>
                    <option value="week">Bu h…ôft…ô</option>
                    <option value="month" selected>Bu ay</option>
                  </select>
                </div>
                <div class="button-group">
                  <a id="load-usage-btn" class="radial-item" data-tooltip="ƒ∞stifad…ômi y√ºkl…ô" aria-label="ƒ∞stifad…ômi y√ºkl…ô" href="#" onclick="event.preventDefault()">
                    <svg class="icon" viewBox="0 0 503.467 503.467" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
                      <g transform="translate(0.5 1)">
                        <circle style="fill:#ECF4F7;" cx="251.234" cy="250.733" r="247.467"/>
                        <path style="fill:#50DD8E;" d="M353.634,476.013c-31.573,14.507-65.707,22.187-102.4,22.187
                          C114.7,498.2,3.767,387.267,3.767,250.733S114.7,3.267,251.234,3.267c46.08,0,89.6,12.8,127.147,34.987l-34.987,39.253
                          c-27.307-14.507-58.88-23.04-92.16-23.04c-108.373,0-196.267,87.893-196.267,196.267c0,40.96,12.8,79.36,34.133,110.933l0,0
                          l3.413,5.12c0.853,0.853,1.707,2.56,2.56,3.413l70.827,93.867L353.634,476.013z"/>
                        <g>
                          <path style="fill:#AAB1BA;" d="M447.5,395.8l2.56,1.707C404.834,458.094,332.3,498.2,251.234,498.2
                            c-81.92,0-155.307-40.96-200.533-102.4l0,0H447.5z"/>
                          <path style="fill:#AAB1BA;" d="M269.154,232.813c4.267,4.267,7.68,11.093,7.68,17.92c0,14.507-11.093,25.6-25.6,25.6
                            c-14.507,0-25.6-11.093-25.6-25.6c0-14.507,11.093-25.6,25.6-25.6C258.914,225.133,264.887,227.693,269.154,232.813"/>
                        </g>
                      </g>
                      <path style="fill:#51565F;" d="M251.734,503.467c-80.213,0-156.16-39.253-203.947-104.107c-0.853-0.853-1.707-2.56-0.853-4.267
                        c0.853-1.707,2.56-2.56,4.267-2.56h354.133c2.56,0,4.267,1.707,4.267,4.267s-1.707,4.267-4.267,4.267h-345.6
                        c46.933,58.88,117.76,93.867,192,93.867c133.973,0,243.2-109.227,243.2-243.2s-109.227-243.2-243.2-243.2
                        c-133.973,0-243.2,109.227-243.2,243.2c0,38.4,8.533,75.093,26.453,109.227c0.853,1.707,0,4.267-1.707,5.973
                        c-1.707,0.853-4.267,0-5.973-1.707C9.387,330.24,0,291.84,0,251.733C0,112.64,112.64,0,251.733,0s251.733,112.64,251.733,251.733
                        S390.827,503.467,251.734,503.467z M89.6,366.933c-0.853,0-2.56-0.853-3.413-1.707C63.147,335.36,51.2,296.96,51.2,251.733
                        C51.2,140.8,140.8,51.2,251.734,51.2c35.84,0,70.827,9.387,101.547,27.307c1.707,0.853,2.56,3.413,1.707,5.973
                        c-0.853,1.707-3.413,2.56-5.973,1.707C320,69.12,285.867,59.734,251.734,59.734c-105.813,0-192,86.187-192,192
                        c0,43.52,11.093,79.36,33.28,108.373c1.707,1.707,0.853,4.267-0.853,5.973C91.307,366.933,90.454,366.933,89.6,366.933z
                         M200.534,307.2c-0.853,0-2.56,0-3.413-0.853c-0.853-0.853-0.853-1.707-0.853-3.413s0-2.56,0.853-3.413l30.72-30.72
                        c-3.413-5.12-5.973-11.093-5.973-17.92c0-16.213,13.653-29.867,29.867-29.867c6.827,0,12.8,2.56,17.92,5.973L394.241,102.4
                        c1.707-1.707,4.267-1.707,5.973,0c0.853,0.853,0.853,1.707,0.853,3.413s0,2.56-0.853,3.413L275.627,233.813
                        c3.413,5.12,5.973,11.093,5.973,17.92c0,16.213-13.653,29.867-29.867,29.867c-6.827,0-12.8-2.56-17.92-5.973l-30.72,30.72
                        C203.094,307.2,201.387,307.2,200.534,307.2z M251.734,230.4c-11.947,0-21.333,9.387-21.333,21.333
                        c0,11.947,9.387,21.333,21.333,21.333s21.333-9.387,21.333-21.333C273.067,239.787,263.68,230.4,251.734,230.4z M465.067,256
                        h-34.133c-2.56,0-4.267-1.707-4.267-4.267c0-2.56,1.707-4.267,4.267-4.267h34.133c2.56,0,4.267,1.707,4.267,4.267
                        C469.334,254.293,467.627,256,465.067,256z M424.96,209.92c-1.707,0-3.413-0.853-4.267-3.413v-0.853
                        c0-1.707,0.853-3.413,3.413-4.267l33.28-8.533c2.56-0.853,4.267,0.853,5.12,3.413v0.853c0,1.707-0.853,3.413-3.413,4.267
                        l-33.28,8.533C425.814,209.92,424.96,209.92,424.96,209.92z M407.04,166.4c-1.707,0-2.56-0.853-3.413-2.56
                        c0-0.853-0.853-1.707-0.853-2.56c0-1.707,0.853-2.56,2.56-3.413L435.2,140.8c1.707-0.853,4.267-0.853,5.973,1.707
                        c0,0.853,0.853,1.707,0.853,2.56c0,1.707-0.853,2.56-2.56,3.413L409.6,165.547C408.747,166.4,407.894,166.4,407.04,166.4z"/>
                    </svg>
                  </a>
                  <a id="load-limits-btn" class="radial-item" data-tooltip="Limitl…ôri y√ºkl…ô" aria-label="Limitl…ôri y√ºkl…ô" href="#" onclick="event.preventDefault()">
                    <svg class="icon" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 492.025 492.025" xml:space="preserve">
                      <g>
                        <g>
                          <path style="fill:#3C92CA;" d="M30.312,246.025c0,5.5,4.4,9.9,9.9,9.9s9.9-4.4,9.9-9.9c0-106.9,86.2-194.1,192.7-195.8l-13.5,13.5
                            c-3.9,3.9-3.9,10.1,0,14c1.9,1.9,4.5,2.9,7,2.9s5.1-1,7-2.9l30.4-30.4c3.9-3.9,3.9-10.1,0-14l-30.4-30.4c-3.9-3.9-10.1-3.9-14,0
                            s-3.9,10.1,0,14l13.6,13.6C125.412,32.025,30.312,128.125,30.312,246.025z"/>
                          <path style="fill:#3C92CA;" d="M451.813,236.125c-5.5,0-9.9,4.4-9.9,9.9c0,106.9-86.2,194.1-192.7,195.8l13.5-13.5
                            c3.9-3.9,3.9-10.1,0-14s-10.1-3.9-14,0l-30.4,30.4c-1.9,1.9-2.9,4.4-2.9,7s1,5.1,2.9,7l30.4,30.4c1.9,1.9,4.5,2.9,7,2.9
                            s5.1-1,7-2.9c3.9-3.9,3.9-10.1,0-14l-13.6-13.6c117.5-1.5,212.6-97.6,212.6-215.5
                            C461.712,240.525,457.313,236.125,451.813,236.125z"/>
                          <path style="fill:#ffffff;" d="M221.612,187.125c-15.7,6.5-28,18.8-34.5,34.5s-6.5,33.1,0,48.8c9.9,23.9,33,39.4,58.9,39.4
                            c8.4,0,16.6-1.6,24.4-4.9c15.7-6.5,28-18.8,34.5-34.5s6.5-33.1,0-48.8c-9.9-23.9-33-39.4-58.9-39.4
                            C237.612,182.225,229.412,183.925,221.612,187.125z M286.612,229.225c4.5,10.9,4.5,22.8,0,33.7s-12.9,19.3-23.8,23.8
                            c-5.4,2.2-11,3.4-16.8,3.4c-17.9,0-33.8-10.7-40.6-27.2c-4.5-10.9-4.5-22.8,0-33.7s12.9-19.3,23.8-23.8c5.4-2.2,11-3.4,16.8-3.4
                            C263.813,202.025,279.813,212.725,286.612,229.225z"/>
                          <path style="fill:#ffffff;" d="M266.012,114.125l-4.1,9.9c-10.5-1.4-21.2-1.4-31.7,0l-4.1-9.9c-3.4-8.2-11.4-13.5-20.3-13.5
                            c-2.9,0-5.7,0.6-8.4,1.7l-18.7,7.7c-5.4,2.2-9.6,6.5-11.9,11.9c-2.2,5.4-2.2,11.4,0,16.8l4.1,9.9c-8.4,6.5-16,14-22.4,22.4
                            l-9.9-4.1c-2.7-1.1-5.5-1.7-8.4-1.7c-8.9,0-16.9,5.3-20.3,13.5l-7.7,18.7c-2.2,5.4-2.2,11.4,0,16.8c2.2,5.4,6.5,9.6,11.9,11.9
                            l9.9,4.1c-1.4,10.6-1.4,21.2,0,31.7l-9.9,4.1c-5.4,2.2-9.6,6.5-11.9,11.9c-2.2,5.4-2.2,11.4,0,16.8l7.7,18.7
                            c3.4,8.2,11.4,13.5,20.3,13.5c2.9,0,5.7-0.6,8.4-1.7l9.9-4.1c6.5,8.4,14,16,22.4,22.4l-4.1,9.9c-4.6,11.2,0.7,24,11.9,28.6
                            l18.7,7.7c2.7,1.1,5.5,1.7,8.4,1.7c8.9,0,16.9-5.3,20.3-13.5l4.1-9.9c10.5,1.4,21.2,1.4,31.7,0l4.1,9.9
                            c3.4,8.2,11.4,13.5,20.3,13.5c2.9,0,5.7-0.6,8.4-1.7l18.7-7.7c5.4-2.2,9.6-6.5,11.9-11.9c2.2-5.4,2.2-11.4,0-16.8l-4.1-9.9
                            c8.4-6.5,16-14,22.4-22.4l9.9,4.1c2.7,1.1,5.5,1.7,8.4,1.7l0,0c8.9,0,16.9-5.3,20.3-13.5l7.7-18.7c2.2-5.4,2.2-11.4,0-16.8
                            s-6.5-9.6-11.9-11.9l-9.9-4.1c1.4-10.6,1.4-21.2,0-31.7l9.9-4.1c5.4-2.2,9.6-6.5,11.9-11.9c2.2-5.4,2.2-11.4,0-16.8l-7.7-18.7
                            c-3.4-8.2-11.4-13.5-20.3-13.5c-2.9,0-5.7,0.6-8.4,1.7l-9.9,4.1c-6.5-8.4-14-16-22.4-22.4l4.1-9.9c2.2-5.4,2.2-11.4,0-16.8
                            s-6.5-9.6-11.9-11.9l-18.7-7.7c-2.7-1.1-5.5-1.7-8.4-1.7C277.412,100.525,269.412,105.825,266.012,114.125z M277.212,138.825
                            l7.1-17.2c0.4-1,1.3-1.3,2-1.3c0.3,0,0.5,0.1,0.8,0.2l18.7,7.7c0.7,0.3,1,0.8,1.1,1.1c0.2,0.4,0.3,1,0,1.6l-7.1,17.2
                            c-1.8,4.4-0.3,9.4,3.6,12c11.3,7.6,20.9,17.1,28.4,28.4c2.6,3.9,7.7,5.5,12,3.7l17.2-7.1c0.3-0.1,0.5-0.2,0.8-0.2
                            c0.7,0,1.6,0.3,2,1.3l7.7,18.7c0.4,1.1-0.1,2.3-1.1,2.8l-17.2,7.1c-4.4,1.8-6.8,6.4-5.9,11.1c2.7,13.3,2.6,26.8,0,40.2
                            c-0.9,4.6,1.6,9.3,5.9,11.1l17.2,7.1c0.7,0.3,1,0.8,1.1,1.1c0.2,0.4,0.3,1,0,1.6l-7.7,18.7c-0.4,1-1.3,1.3-2,1.3
                            c-0.3,0-0.5-0.1-0.8-0.2l-17.2-7.1c-4.4-1.8-9.4-0.3-12,3.6c-7.6,11.3-17.1,20.9-28.4,28.4c-3.9,2.6-5.5,7.7-3.7,12l7.1,17.2
                            c0.3,0.7,0.2,1.3,0,1.6c-0.2,0.4-0.5,0.9-1.2,1.1l-18.7,7.7c-0.3,0.1-0.5,0.2-0.8,0.2c-0.7,0-1.6-0.3-2-1.3l-7.1-17.2
                            c-1.6-3.8-5.2-6.1-9.1-6.1c-0.6,0-1.3,0.1-1.9,0.2c-13.2,2.6-26.9,2.6-40.2,0c-4.6-0.9-9.3,1.6-11.1,5.9l-7.1,17.2
                            c-0.4,1-1.3,1.3-2,1.3c-0.3,0-0.5-0.1-0.8-0.2l-18.7-7.7c-1.1-0.4-1.6-1.7-1.1-2.8l7.1-17.2c1.8-4.4,0.3-9.4-3.6-12
                            c-11.3-7.6-20.9-17.1-28.4-28.4c-2.6-3.9-7.7-5.5-12-3.7l-17.2,7.1c-0.3,0.1-0.5,0.2-0.8,0.2c-0.7,0-1.6-0.3-2-1.3l-7.7-18.7
                            c-0.3-0.7-0.2-1.3,0-1.6c0.2-0.4,0.5-0.9,1.1-1.1l17.2-7.1c4.4-1.8,6.8-6.4,5.9-11.1c-2.7-13.3-2.6-26.8,0-40.2
                            c0.9-4.6-1.6-9.3-5.9-11.1l-17.2-7.1c-0.7-0.3-1-0.8-1.1-1.1c-0.2-0.4-0.3-1,0-1.6l7.7-18.7c0.4-1,1.3-1.3,2-1.3
                            c0.3,0,0.5,0.1,0.8,0.2l17.2,7.1c4.4,1.8,9.4,0.3,12-3.6c7.6-11.3,17.1-20.9,28.4-28.4c3.9-2.6,5.5-7.7,3.7-12l-7.1-17.2
                            c-0.3-0.7-0.2-1.3,0-1.6c0.2-0.4,0.5-0.9,1.2-1.2l18.7-7.7c0.3-0.1,0.5-0.2,0.8-0.2c0.7,0,1.6,0.3,2,1.3l7.1,17.2
                            c1.8,4.4,6.5,6.8,11.1,5.9c13.2-2.6,26.9-2.6,40.2,0C270.712,145.625,275.412,143.225,277.212,138.825z"/>
                        </g>
                      </g>
                    </svg>
                  </a>
                  <a id="load-history-btn" class="radial-item" data-tooltip="Tarix√ß…ôni y√ºkl…ô" aria-label="Tarix√ß…ôni y√ºkl…ô" href="#" onclick="event.preventDefault()">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path fill-rule="evenodd" clip-rule="evenodd" d="M5.07868 5.06891C8.87402 1.27893 15.0437 1.31923 18.8622 5.13778C22.6824 8.95797 22.7211 15.1313 18.9262 18.9262C15.1312 22.7211 8.95793 22.6824 5.13774 18.8622C2.87389 16.5984 1.93904 13.5099 2.34047 10.5812C2.39672 10.1708 2.775 9.88377 3.18537 9.94002C3.59575 9.99627 3.88282 10.3745 3.82658 10.7849C3.4866 13.2652 4.27782 15.881 6.1984 17.8016C9.44288 21.0461 14.6664 21.0646 17.8655 17.8655C21.0646 14.6664 21.046 9.44292 17.8015 6.19844C14.5587 2.95561 9.33889 2.93539 6.13935 6.12957L6.88705 6.13333C7.30126 6.13541 7.63535 6.47288 7.63327 6.88709C7.63119 7.3013 7.29372 7.63539 6.87951 7.63331L4.33396 7.62052C3.92269 7.61845 3.58981 7.28556 3.58774 6.8743L3.57495 4.32874C3.57286 3.91454 3.90696 3.57707 4.32117 3.57498C4.73538 3.5729 5.07285 3.907 5.07493 4.32121L5.07868 5.06891Z" fill="#ffffff"/>
                      <path opacity="0.5" d="M12 7.25C12.4142 7.25 12.75 7.58579 12.75 8V11.6893L15.0303 13.9697C15.3232 14.2626 15.3232 14.7374 15.0303 15.0303C14.7374 15.3232 14.2626 15.3232 13.9697 15.0303L11.5429 12.6036C11.3554 12.416 11.25 12.1617 11.25 11.8964V8C11.25 7.58579 11.5858 7.25 12 7.25Z" fill="#ffffff"/>
                    </svg>
                  </a>
                </div>
                <div id="usage-result" class="hidden">
                  <div id="usage-ui" class="hidden">
                    <h4>ƒ∞stifad…ô Paneli</h4>
                    <div id="usage-dashboard" class="usage-dashboard"></div>
                    <div id="usage-history" class="usage-history hidden">
                      <h4>Son Aktivlik</h4>
                      <div id="history-container"></div>
                    </div>
                  </div>
                  <div id="usage-json" class="test-result hidden">
                    <h4>Xam M…ôlumat:</h4>
                    <pre id="usage-result-content"></pre>
                  </div>
                </div>
              </div>

              <!-- Billing Management -->
              <div class="billing-subsection">
                <h3>√ñd…ôni≈ül…ôrin idar…ô edilm…ôsi</h3>
                <div class="button-group">
                  <a id="load-plans-btn" class="radial-item" data-tooltip="Planlarƒ± y√ºkl…ô" aria-label="Planlarƒ± y√ºkl…ô" href="#" onclick="event.preventDefault()">
                    <svg class="icon" viewBox="-21 0 298 298" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid">
                      <g>
                        <polyline fill="#00B46F" points="192 112.384 256 150.326857 256 224.768 192 261.248 128 224.768 128 150.345143"></polyline>
                        <polyline fill="#2294D9" points="128 0 192 37.9428571 192 112.384 128 148.864 64 112.384 64 37.9611429"></polyline>
                        <polyline fill="#2294D9" points="192 37.9428571 256 75.8857143 256 150.336 192 186.816 128 150.336 128 75.8857143"></polyline>
                        <polyline fill="#F85551" points="64 37.9428571 128 75.8857143 128 150.336 64 186.816 0 150.336 0 75.8857143"></polyline>
                        <polyline fill="#F85551" points="64 112.384 128 150.326857 128 224.768 64 261.248 0 224.768 0 150.345143"></polyline>
                        <polyline fill="#00B46F" points="128 148.873143 192 186.816 192 261.257143 128 297.737143 64 261.257143 64 186.816"></polyline>
                        <path d="M192,37.9428571 L128,75.8857143 L64,37.9428571 L128,0 L192,37.9428571 Z M256,75.8857143 L192,113.846857 L128,75.904 L192,37.9611429 L256,75.904 L256,75.8857143 Z" fill="#30B2E9"></path>
                        <polyline fill="#00AB64" points="128 223.305143 128 148.882286 64 186.825143 64 261.248"></polyline>
                        <polyline fill="#00CE8E" points="192 186.816 128 223.296 64 186.816 128 148.873143"></polyline>
                        <polygon fill="#00C783" points="128 223.305143 64 186.825143 128 148.882286"></polygon>
                        <polygon fill="#2CAEE7" points="128 75.8857143 64 37.9428571 128 0"></polygon>
                        <polyline fill="#FB716C" points="128 75.8857143 64 113.846857 0 75.904 64 37.9611429"></polyline>
                        <polyline fill="#1F8ED6" points="256 150.336 192 186.816 128 148.873143 192 113.856"></polyline>
                        <polygon fill="#F64743" points="63.0125714 260.626286 0 224.146286 63.0125714 186.185143 63.0125714 260.626286"></polygon>
                        <polyline fill="#F96560" points="64 113.846857 64 37.9611429 128 75.904 128 148.864"></polyline>
                        <polyline fill="#B71D1D" points="128 148.873143 128 75.8857143 64 113.846857 64 186.806857"></polyline>
                        <polygon fill="#B21A1A" points="128 148.873143 64 113.856 128 75.8857143"></polygon>
                        <polygon fill-opacity="0.2" fill="#10161A" style="mix-blend-mode: soft-light;" points="256 224.768 192 186.825143 256 150.345143 256 224.768"></polygon>
                        <path d="M192,261.257143 L192,186.816 L128,223.296 L128,297.746286 L192,261.266286 L192,261.257143 Z M256,224.777143 L256,150.336 L192,186.816 L192,261.257143 L256,224.777143 Z" fill="#007233"></path>
                        <polygon fill="#00682C" points="256 224.768 192 186.825143 256 150.345143 256 224.768"></polygon>
                        <polyline fill="#0759BA" points="256 150.336 256 75.8857143 192 113.846857 192 186.806857"></polyline>
                        <polygon fill="#0860BF" points="256 150.336 192 113.856 256 75.8857143"></polygon>
                        <path d="M0,75.8857143 L64,112.384 L128,75.904 L65.4628571,114.578286 L64,186.514286 C64,186.541714 64,186.514286 64,186.514286 L62.5371429,114.56 L0,75.8857143 Z" fill="#FEBCB7" opacity="0.78"></path>
                        <polyline fill="#4EDCF8" opacity="0.78" points="128 75.8857143 192 112.384 256 75.904 193.462857 114.578286 192 186.806857 190.537143 114.578286"></polyline>
                        <path d="M64,186.816 L128,221.851429 L192,186.816 L129.462857,224.027429 L128,297.691429 C128,297.718857 128,297.691429 128,297.691429 L126.537143,224.036571 L64,186.825143 L64,186.816 Z" fill="#00F3C9" opacity="0.78"></path>
                      </g>
                    </svg>
                  </a>
                  <a id="load-subscription-btn" class="radial-item" data-tooltip="Abun…ôliyi y√ºkl…ô" aria-label="Abun…ôliyi y√ºkl…ô" href="#" onclick="event.preventDefault()">
                    <svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
                      <path d="M515.1 920.6H228V104.2h567.7v339.6c0 11 9 20 20 20s20-9 20-20V96c0-17.5-14.3-31.8-31.8-31.8H219.7C202.2 64.2 188 78.4 188 96v832.9c0 17.5 14.3 31.8 31.8 31.8h295.4c11 0 20-9 20-20s-9-20.1-20.1-20.1z" fill="#666666" />
                      <path d="M749 384.6c0-11-9-20-20-20H283c-11 0-20 9-20 20s9 20 20 20h446c11 0 20-9 20-20zM541 522.1c0-11-6.9-20-15.2-20H278.3c-8.4 0-15.2 9-15.2 20s6.9 20 15.2 20h247.4c8.4 0 15.3-9 15.3-20zM278.3 640.6c-8.4 0-15.2 9-15.2 20s6.9 20 15.2 20h168.6c8.4 0 15.2-9 15.2-20s-6.9-20-15.2-20H278.3zM736.8 509.5c-124.3 0-225 100.7-225 225s100.7 225 225 225 225-100.7 225-225-100.8-225-225-225zM900.2 663l-188 188c-0.7 1.4-1.6 2.6-2.8 3.8-2.3 2.3-5.2 3.7-8.3 4.2-5.1 1.3-10.6 0-14.6-3.9-1.4-1.4-2.5-3.1-3.2-4.8l-103.8-104c-5.9-5.9-5.9-15.6 0-21.5s15.6-5.9 21.5 0l97.1 97.1 180.5-180.5c5.9-5.9 15.6-5.9 21.5 0 6 6 6 15.7 0.1 21.6z" fill="#666666" />
                      <path d="M726.8 300.1h-429c-14.8 0-26.8-12-26.8-26.8v-81.4c0-14.8 12-26.8 26.8-26.8h429c14.8 0 26.8 12 26.8 26.8v81.4c0 14.8-12 26.8-26.8 26.8z" fill="#CCCCCC" />
                    </svg>
                  </a>
                  <a id="test-checkout-btn" class="radial-item" data-tooltip="√ñd…ôni≈ü sƒ±naƒüƒ± (Tezlikl…ô)" aria-label="√ñd…ôni≈ü sƒ±naƒüƒ± (Tezlikl…ô)" href="#" onclick="event.preventDefault()">
                    <svg class="icon" fill="#000000" viewBox="0 0 32 32" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;" version="1.1" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:serif="http://www.serif.com/" xmlns:xlink="http://www.w3.org/1999/xlink">
                      <g transform="matrix(1,0,0,1,-144,-96)">
                        <g transform="matrix(1.09091,0,0,1.14286,-119.273,36)">
                          <path d="M266.858,63.993C266.894,63.743 266.815,63.49 266.64,63.3C266.466,63.109 266.215,63 265.95,63C262.238,63 249.762,63 246.05,63C245.785,63 245.534,63.109 245.36,63.3C245.185,63.49 245.106,63.743 245.142,63.993C245.487,66.409 246.372,72.606 246.784,75.486C246.908,76.354 247.683,77 248.6,77C252.016,77 259.984,77 263.4,77C264.317,77 265.092,76.354 265.216,75.486C265.628,72.606 266.513,66.409 266.858,63.993Z" style="fill:rgb(144,224,239);"/>
                        </g>
                        <g transform="matrix(1.25,0,0,1.25,15.25,-7.75)">
                          <circle cx="123" cy="103" r="4" style="fill:rgb(144,224,239);"/>
                        </g>
                        <path d="M167.382,107L152.618,107L155.894,100.447C156.141,99.954 155.941,99.352 155.447,99.106C154.954,98.859 154.352,99.059 154.106,99.553L150.382,107L149.146,107C148.568,107 148.019,107.25 147.639,107.685C147.259,108.12 147.086,108.698 147.164,109.27C147.541,112.032 148.506,119.114 148.955,122.405C149.158,123.892 150.427,125 151.928,125C155.741,125 164.478,125 164.478,125C164.495,125 164.512,125 164.528,124.999C165.627,126.227 167.224,127 169,127C172.311,127 175,124.311 175,121C175,118.76 173.77,116.805 171.949,115.775L172.836,109.27C172.914,108.698 172.741,108.12 172.361,107.685C171.981,107.25 171.432,107 170.854,107L169.618,107L165.894,99.553C165.648,99.059 165.046,98.859 164.553,99.106C164.059,99.352 163.859,99.954 164.106,100.447L167.382,107ZM169,117C171.208,117 173,118.792 173,121C173,123.208 171.208,125 169,125C166.792,125 165,123.208 165,121C165,118.792 166.792,117 169,117ZM168,120L167,120C166.448,120 166,120.448 166,121C166,121.552 166.448,122 167,122L168,122L168,123C168,123.552 168.448,124 169,124C169.552,124 170,123.552 170,123L170,122L171,122C171.552,122 172,121.552 172,121C172,120.448 171.552,120 171,120L170,120L170,119C170,118.448 169.552,118 169,118C168.448,118 168,118.448 168,119L168,120ZM170.854,109L149.146,109L150.937,122.135C151.004,122.631 151.428,123 151.928,123L163.342,123C163.12,122.374 163,121.701 163,121C163,117.689 165.689,115 169,115C169.349,115 169.691,115.03 170.024,115.087L170.854,109Z" style="fill:rgb(25,144,167);"/>
                      </g>
                    </svg>
                  </a>
                  <a id="billing-portal-btn" class="radial-item" data-tooltip="√ñd…ôni≈ül…ôri idar…ô et (Tezlikl…ô)" aria-label="√ñd…ôni≈ül…ôri idar…ô et (Tezlikl…ô)" href="#" onclick="event.preventDefault()">
                    <svg class="icon" viewBox="0 0 24 24" version="1.1" baseProfile="tiny" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" overflow="visible" xml:space="preserve">
                      <g>
                        <rect y="0" fill="none" width="24" height="24"/>
                        <g transform="translate(0.000000, 5.000000)">
                          <path fill-rule="evenodd" fill="#85A4E6" d="M22.5,15.2h-21c-0.8,0-1.5-0.7-1.5-1.5V0.2c0-0.8,0.7-1.5,1.5-1.5h21
                            c0.8,0,1.5,0.7,1.5,1.5v13.5C24,14.6,23.3,15.2,22.5,15.2L22.5,15.2z"/>
                          <path fill-rule="evenodd" fill="#5C85DE" d="M22.5,15.2H12V-1.2h10.5c0.8,0,1.5,0.7,1.5,1.5v13.5C24,14.6,23.3,15.2,22.5,15.2
                            L22.5,15.2z"/>
                          <rect y="1" fill-rule="evenodd" fill="#5C85DE" width="24" height="3"/>
                          <rect x="12" y="1" fill-rule="evenodd" fill="#3367D6" width="12" height="3"/>
                          <rect x="2.2" y="5.5" fill-rule="evenodd" fill="#FFFFFF" width="19.5" height="2.2"/>
                          <rect x="2.2" y="10" fill-rule="evenodd" fill="#5C85DE" width="4.5" height="3"/>
                          <rect x="13.5" y="10.8" fill-rule="evenodd" fill="#FFFFFF" width="1.5" height="1.5"/>
                          <rect x="16.5" y="10.8" fill-rule="evenodd" fill="#FFFFFF" width="1.5" height="1.5"/>
                          <rect x="19.5" y="10.8" fill-rule="evenodd" fill="#FFFFFF" width="1.5" height="1.5"/>
                        </g>
                      </g>
                    </svg>
                  </a>
                </div>
                <div id="billing-result" class="hidden">
                  <div id="plans-ui" class="hidden">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                      <h4>M√∂vcud Planlar</h4>
                      <a id="close-plans-btn" class="radial-item" data-tooltip="Baƒüla" aria-label="Baƒüla" href="#" onclick="event.preventDefault()">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                          <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                      </a>
                    </div>
                    <div id="plans-container" class="plans-grid"></div>
                  </div>
                  <div id="subscription-ui" class="hidden">
                    <h4>Abun…ôliyiniz</h4>
                    <div id="subscription-container"></div>
                  </div>
                  <div id="billing-json" class="test-result hidden">
                    <h4>Xam M…ôlumat:</h4>
                    <pre id="billing-result-content"></pre>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Protected Endpoints Testing -->
        <div class="admin-section">
          <h2>Qorunan endpointl…ôrin sƒ±nanmasƒ±</h2>
          <div class="admin-content">
            <div class="form-group">
              <label for="protected-api-key">API a√ßarƒ± (ist…ôy…ô g√∂r…ô)</label>
              <input type="password" id="protected-api-key" placeholder="lnk_... (sesiyanƒ± istifad…ô etm…ôk √º√ß√ºn bo≈ü saxlayƒ±n)">
            </div>
            <div class="button-group">
              <button onclick="testProtectedEndpoint('/api/protected-example')" class="btn btn-secondary">Qorunan n√ºmun…ôni sƒ±na</button>
              <button onclick="testProtectedEndpoint('/api/statistics')" class="btn btn-secondary">Statistikanƒ± sƒ±na</button>
              <button onclick="testProtectedEndpoint('/api/site-averages?host=bbc.com')" class="btn btn-secondary">Sayt ortalamalarƒ±nƒ± sƒ±na</button>
              <button onclick="testProtectedEndpoint('/api/recent-analyses')" class="btn btn-secondary">Son t…ôhlill…ôri sƒ±na</button>
            </div>
            <div id="protected-test-result" class="test-result hidden">
              <h4>Qorunan Endpoint N…ôtic…ôsi:</h4>
              <pre id="protected-test-result-content"></pre>
            </div>
          </div>
        </div>

        <!-- Messages -->
        <div id="messages"></div>
      </div>
    </main>
    <div id="site-footer"></div>
  </div>

  <script>
    // Qorunan endpointl…ôri sƒ±na funksiyasƒ±
    async function testProtectedEndpoint(endpoint) {
      const apiKey = document.getElementById('protected-api-key').value;
      const resultEl = document.getElementById('protected-test-result');
      const contentEl = document.getElementById('protected-test-result-content');
      
      resultEl.classList.remove('hidden');
      contentEl.textContent = 'Sƒ±na edilir...';
      
      try {
        const headers = {
          'Content-Type': 'application/json'
        };
        
        if (apiKey) {
          headers['Authorization'] = `Bearer ${apiKey}`;
        }
        
        const response = await fetch(endpoint, {
          method: 'GET',
          headers: headers
        });
        
        const data = await response.json();
        
        const result = {
          endpoint: endpoint,
          status: response.status,
          statusText: response.statusText,
          headers: Object.fromEntries(response.headers.entries()),
          data: data,
          timestamp: new Date().toISOString()
        };
        
        contentEl.textContent = JSON.stringify(result, null, 2);
        
        if (response.ok) {
          contentEl.className = 'success';
        } else {
          contentEl.className = 'error';
        }
      } catch (error) {
        const result = {
          endpoint: endpoint,
          error: error.message,
          timestamp: new Date().toISOString()
        };
        
        contentEl.textContent = JSON.stringify(result, null, 2);
        contentEl.className = 'error';
      }
    }

    // ƒ∞stifad…ônin izl…ônm…ôsi funksiyalarƒ±
    async function loadUsage() {
      const period = document.getElementById('usage-period').value;
      const resultEl = document.getElementById('usage-result');
      const usageUI = document.getElementById('usage-ui');
      const usageDashboard = document.getElementById('usage-dashboard');
      const jsonEl = document.getElementById('usage-json');
      const contentEl = document.getElementById('usage-result-content');
      
      resultEl.classList.remove('hidden');
      usageUI.classList.remove('hidden');
      usageDashboard.innerHTML = '<div class="empty-state"><h4>ƒ∞stifad…ô m…ôlumatlarƒ± y√ºkl…ônir...</h4><p>ƒ∞stifad…ô statistikalarƒ±nƒ±zƒ± g…ôtiririk, z…ôhm…ôt olmasa g√∂zl…ôyin.</p></div>';
      
      try {
        const response = await fetch(`/api/usage/my-usage?period=${period}&history=true&historyLimit=20`);
        const data = await response.json();
        
        if (response.ok && data.success) {
          renderUsageUI(data.usage, data.history);
          
          // JSON b√∂lm…ôsind…ô xam m…ôlumatƒ± da g√∂st…ôr
          const result = {
            endpoint: `/api/usage/my-usage?period=${period}`,
            status: response.status,
            statusText: response.statusText,
            data: data,
            timestamp: new Date().toISOString()
          };
          
          contentEl.textContent = JSON.stringify(result, null, 2);
          contentEl.className = 'success';
          jsonEl.classList.remove('hidden');
        } else {
          throw new Error(data.message || 'ƒ∞stifad…ô m…ôlumatlarƒ±nƒ± y√ºkl…ôm…ôk m√ºmk√ºn olmadƒ±');
        }
      } catch (error) {
        usageDashboard.innerHTML = `
          <div class="empty-state">
            <h4>ƒ∞stifad…ô y√ºkl…ôn…ôrk…ôn s…ôhv</h4>
            <p>${error.message}</p>
          </div>
        `;
        
        const result = {
          endpoint: '/api/usage/my-usage',
          error: error.message,
          timestamp: new Date().toISOString()
        };
        
        contentEl.textContent = JSON.stringify(result, null, 2);
        contentEl.className = 'error';
        jsonEl.classList.remove('hidden');
      }
    }
    
    function renderUsageUI(usage, history) {
      const dashboard = document.getElementById('usage-dashboard');
      const historyContainer = document.getElementById('history-container');
      const historySection = document.getElementById('usage-history');
      
      // ƒ∞stifad…ô panelini qur
      const usageHTML = `
        <div class="usage-card">
          <h4>√úmumi sorƒüular</h4>
          <div class="usage-value">${usage.requests || 0}</div>
          <div class="usage-label">bu ${usage.period} …ôrzind…ô sorƒüular</div>
        </div>

        <div class="usage-card">
          <h4>Uƒüurlu sorƒüular</h4>
          <div class="usage-value">${usage.successfulRequests || 0}</div>
          <div class="usage-label">uƒüurlu √ßaƒüƒ±rƒ±≈ülar</div>
        </div>

        <div class="usage-card">
          <h4>Uƒüursuz sorƒüular</h4>
          <div class="usage-value">${usage.failedRequests || 0}</div>
          <div class="usage-label">uƒüursuz √ßaƒüƒ±rƒ±≈ülar</div>
        </div>

        <div class="usage-card">
          <h4>√úmumi x…ôrc</h4>
          <div class="usage-value">$${usage.costDollars || '0.00'}</div>
          <div class="usage-label">bu ${usage.period} …ôrzind…ô</div>
        </div>
      `;
      
      dashboard.innerHTML = usageHTML;
      
      // M√∂vcuddursa istifad…ô tarix√ß…ôsini g√∂st…ôr
      if (history && history.length > 0) {
        const historyHTML = history.map(item => `
          <div class="history-item">
            <div class="history-endpoint">${item.endpoint}</div>
            <div class="history-cost">$${(item.cost / 100).toFixed(4)}</div>
            <div class="${item.success ? 'history-success' : 'history-failed'}">
              ${item.success ? '‚úì' : '‚úó'}
            </div>
          </div>
        `).join('');
        
        historyContainer.innerHTML = historyHTML;
        historySection.classList.remove('hidden');
      } else {
        historySection.classList.add('hidden');
      }
    }

    async function loadLimits() {
      const resultEl = document.getElementById('usage-result');
      const usageUI = document.getElementById('usage-ui');
      const usageDashboard = document.getElementById('usage-dashboard');
      const jsonEl = document.getElementById('usage-json');
      const contentEl = document.getElementById('usage-result-content');
      
      resultEl.classList.remove('hidden');
      usageUI.classList.remove('hidden');
      usageDashboard.innerHTML = '<div class="empty-state"><h4>Limitl…ôr y√ºkl…ônir...</h4><p>ƒ∞stifad…ô limitl…ôrinizi g…ôtiririk, z…ôhm…ôt olmasa g√∂zl…ôyin.</p></div>';
      
      try {
        const response = await fetch('/api/usage/limits');
        const data = await response.json();
        
        if (response.ok && data.success) {
          renderLimitsUI(data);
          
          // JSON b√∂lm…ôsind…ô xam m…ôlumatƒ± da g√∂st…ôr
          const result = {
            endpoint: '/api/usage/limits',
            status: response.status,
            statusText: response.statusText,
            data: data,
            timestamp: new Date().toISOString()
          };
          
          contentEl.textContent = JSON.stringify(result, null, 2);
          contentEl.className = 'success';
          jsonEl.classList.remove('hidden');
        } else {
          throw new Error(data.message || 'Limitl…ôri y√ºkl…ôm…ôk m√ºmk√ºn olmadƒ±');
        }
      } catch (error) {
        usageDashboard.innerHTML = `
          <div class="empty-state">
            <h4>Limitl…ôr y√ºkl…ôn…ôrk…ôn s…ôhv</h4>
            <p>${error.message}</p>
          </div>
        `;
        
        const result = {
          endpoint: '/api/usage/limits',
          error: error.message,
          timestamp: new Date().toISOString()
        };
        
        contentEl.textContent = JSON.stringify(result, null, 2);
        contentEl.className = 'error';
        jsonEl.classList.remove('hidden');
      }
    }
    
    function renderLimitsUI(data) {
      const dashboard = document.getElementById('usage-dashboard');
      const { plan, limits = {}, currentUsage = {}, canMakeRequest = false, exceeded = {} } = data;
      
      // Provide fallback values if data is missing
      const safeLimits = {
        maxRequestsPerMonth: limits.maxRequestsPerMonth || 0,
        maxCostPerMonth: limits.maxCostPerMonth || 0,
        costPerRequest: limits.costPerRequest || 0
      };
      
      const safeCurrentUsage = {
        requests: currentUsage.requests || 0,
        cost: currentUsage.cost || 0,
        costDollars: currentUsage.costDollars || '0.00'
      };
      
      const requestPercentage = safeLimits.maxRequestsPerMonth > 0 ? 
        (safeCurrentUsage.requests / safeLimits.maxRequestsPerMonth) * 100 : 0;
      const costPercentage = safeLimits.maxCostPerMonth > 0 ? 
        (safeCurrentUsage.cost / safeLimits.maxCostPerMonth) * 100 : 0;
      
      const requestStatus = requestPercentage >= 90 ? 'danger' : requestPercentage >= 70 ? 'warning' : '';
      const costStatus = costPercentage >= 90 ? 'danger' : costPercentage >= 70 ? 'warning' : '';
      
      const limitsHTML = `
        <div class="limit-card">
          <h4>Sorƒüu limitl…ôri</h4>
          <div class="limit-status">
            <div class="status-dot ${requestStatus}"></div>
            <div class="limit-text">
              <span class="limit-usage">${safeCurrentUsage.requests}</span> /
              ${safeLimits.maxRequestsPerMonth === -1 ? 'Limitsiz' : safeLimits.maxRequestsPerMonth.toLocaleString()} sorƒüu
            </div>
          </div>
          ${safeLimits.maxRequestsPerMonth > 0 ? `
            <div class="progress-bar">
              <div class="progress-fill ${requestStatus}" style="width: ${Math.min(requestPercentage, 100)}%"></div>
            </div>
          ` : ''}
          <div class="limit-text">
            ${canMakeRequest ? '‚úÖ Daha √ßox sorƒüu g√∂nd…ôr…ô bil…ôrsiniz' : '‚ùå Sorƒüu limiti a≈üƒ±lƒ±b'}
          </div>
        </div>

        <div class="limit-card">
          <h4>X…ôrc limitl…ôri</h4>
          <div class="limit-status">
            <div class="status-dot ${costStatus}"></div>
            <div class="limit-text">
              <span class="limit-usage">$${safeCurrentUsage.costDollars}</span> /
              ${safeLimits.maxCostPerMonth === -1 ? 'Limitsiz' : `$${safeLimits.maxCostPerMonth.toFixed(2)}`} x…ôrc
            </div>
          </div>
          ${safeLimits.maxCostPerMonth > 0 ? `
            <div class="progress-bar">
              <div class="progress-fill ${costStatus}" style="width: ${Math.min(costPercentage, 100)}%"></div>
            </div>
          ` : ''}
          <div class="limit-text">
            ${!exceeded.cost ? '‚úÖ X…ôrc limiti daxilind…ôdir' : '‚ùå X…ôrc limiti a≈üƒ±lƒ±b'}
          </div>
        </div>

        <div class="limit-card">
          <h4>Planƒ±n t…ôf…ôrr√ºatlarƒ±</h4>
          <div class="limit-text">
            <strong>Cari plan:</strong> ${typeof plan === 'object' ? (plan.name || plan.id || 'Nam…ôlum') : (plan || 'Nam…ôlum')}<br>
            <strong>Bir sorƒüu √º√ß√ºn x…ôrc:</strong> $${safeLimits.costPerRequest.toFixed(4)}<br>
            <strong>Status:</strong> ${canMakeRequest ? 'Aktiv' : 'M…ôhdud'}
          </div>
        </div>
      `;
      
      dashboard.innerHTML = limitsHTML;
    }

    async function loadHistory() {
      const period = document.getElementById('usage-period').value;
      const resultEl = document.getElementById('usage-result');
      const usageUI = document.getElementById('usage-ui');
      const usageDashboard = document.getElementById('usage-dashboard');
      const historySection = document.getElementById('usage-history');
      const historyContainer = document.getElementById('history-container');
      const jsonEl = document.getElementById('usage-json');
      const contentEl = document.getElementById('usage-result-content');
      
      resultEl.classList.remove('hidden');
      usageUI.classList.remove('hidden');
      usageDashboard.innerHTML = '<div class="empty-state"><h4>Tarix√ß…ô y√ºkl…ônir...</h4><p>ƒ∞stifad…ô tarix√ß…ônizi g…ôtiririk, z…ôhm…ôt olmasa g√∂zl…ôyin.</p></div>';
      
      try {
        const response = await fetch(`/api/usage/my-usage?period=${period}&history=true&historyLimit=50`);
        const data = await response.json();
        
        if (response.ok && data.success) {
          // Bu funksiya √º√ß√ºn yalnƒ±z tarix√ß…ô b√∂lm…ôsini g√∂st…ôr
          usageDashboard.innerHTML = '<div class="empty-state"><h4>ƒ∞stifad…ô tarix√ß…ôsi</h4><p>API istifad…ônizin son aktivliyi.</p></div>';
          
          if (data.history && data.history.length > 0) {
            const historyHTML = data.history.map(item => `
              <div class="history-item">
                <div class="history-endpoint">${item.endpoint}</div>
                <div class="history-cost">$${(item.cost / 100).toFixed(4)}</div>
                <div class="${item.success ? 'history-success' : 'history-failed'}">
                  ${item.success ? '‚úì' : '‚úó'}
                </div>
              </div>
            `).join('');
            
            historyContainer.innerHTML = historyHTML;
            historySection.classList.remove('hidden');
          } else {
            historyContainer.innerHTML = '<div class="empty-state"><h4>Tarix√ß…ô tapƒ±lmadƒ±</h4><p>Bu d√∂vr √º√ß√ºn istifad…ô tarix√ß…ôsi tapƒ±lmadƒ±.</p></div>';
            historySection.classList.remove('hidden');
          }
          
          // JSON b√∂lm…ôsind…ô xam m…ôlumatƒ± da g√∂st…ôr
          const result = {
            endpoint: `/api/usage/my-usage?period=${period}&history=true`,
            status: response.status,
            statusText: response.statusText,
            data: data,
            timestamp: new Date().toISOString()
          };
          
          contentEl.textContent = JSON.stringify(result, null, 2);
          contentEl.className = 'success';
          jsonEl.classList.remove('hidden');
        } else {
          throw new Error(data.message || 'Tarix√ß…ôni y√ºkl…ôm…ôk m√ºmk√ºn olmadƒ±');
        }
      } catch (error) {
        usageDashboard.innerHTML = `
          <div class="empty-state">
            <h4>Tarix√ß…ô y√ºkl…ôn…ôrk…ôn s…ôhv</h4>
            <p>${error.message}</p>
          </div>
        `;
        
        const result = {
          endpoint: '/api/usage/my-usage?history=true',
          error: error.message,
          timestamp: new Date().toISOString()
        };
        
        contentEl.textContent = JSON.stringify(result, null, 2);
        contentEl.className = 'error';
        jsonEl.classList.remove('hidden');
      }
    }

    // √ñd…ôni≈ül…ôrin idar…ô edilm…ôsi funksiyalarƒ±
    async function loadPlans() {
      const resultEl = document.getElementById('billing-result');
      const plansUI = document.getElementById('plans-ui');
      const plansContainer = document.getElementById('plans-container');
      const jsonEl = document.getElementById('billing-json');
      const contentEl = document.getElementById('billing-result-content');
      
      resultEl.classList.remove('hidden');
      plansUI.classList.remove('hidden');
      plansContainer.innerHTML = '<div class="empty-state"><h4>Planlar y√ºkl…ônir...</h4><p>M√∂vcud planlarƒ± g…ôtiririk, z…ôhm…ôt olmasa g√∂zl…ôyin.</p></div>';
      
      try {
        const response = await fetch('/api/billing/plans');
        const data = await response.json();
        
        if (response.ok && data.success) {
          renderPlansUI(data.plans);
          
          // JSON b√∂lm…ôsind…ô xam m…ôlumatƒ± da g√∂st…ôr
          const result = {
            endpoint: '/api/billing/plans',
            status: response.status,
            statusText: response.statusText,
            data: data,
            timestamp: new Date().toISOString()
          };
          
          contentEl.textContent = JSON.stringify(result, null, 2);
          contentEl.className = 'success';
          jsonEl.classList.remove('hidden');
        } else {
          throw new Error(data.message || 'Planlarƒ± y√ºkl…ôm…ôk m√ºmk√ºn olmadƒ±');
        }
      } catch (error) {
        plansContainer.innerHTML = `
          <div class="empty-state">
            <h4>Planlar y√ºkl…ôn…ôrk…ôn s…ôhv</h4>
            <p>${error.message}</p>
          </div>
        `;
        
        const result = {
          endpoint: '/api/billing/plans',
          error: error.message,
          timestamp: new Date().toISOString()
        };
        
        contentEl.textContent = JSON.stringify(result, null, 2);
        contentEl.className = 'error';
        jsonEl.classList.remove('hidden');
      }
    }
    
    function renderPlansUI(plans) {
      const container = document.getElementById('plans-container');
      
      if (!plans || plans.length === 0) {
        container.innerHTML = '<div class="empty-state"><h4>Plan tapƒ±lmadƒ±</h4><p>He√ß bir abun…ô planƒ± a≈ükarlanmadƒ±.</p></div>';
        return;
      }
      
      // Azerbaijani translations for plan names and descriptions
      const planTranslations = {
        'Free': {
          name: 'Pulsuz',
          description: 'T…ôkmill…ô≈üdiricil…ôr v…ô ki√ßik layih…ôl…ôr √º√ß√ºn m√ºk…ômm…ôl. Media t…ôhlili il…ô ba≈ülamaq √º√ß√ºn …ôsas etibarlƒ±lƒ±q v…ô q…ôr…ôz qiym…ôtl…ôndirm…ôsi daxildir.',
          billing: 'H…ômi≈ü…ôlik pulsuz'
        },
        'Basic': {
          name: '∆èsas',
          description: 'Ki√ßik biznesl…ôr, bloq√ßular v…ô m…ôzmun yaradƒ±cƒ±larƒ± √º√ß√ºn ideal. Artan layih…ôl…ôr √º√ß√ºn prioritet d…ôst…ôk v…ô y√ºks…ôk istifad…ô limitl…ôri daxildir.',
          billing: 'Tezlikl…ô'
        },
        'Pro': {
          name: 'Pe≈ü…ôkar',
          description: 'Media ≈üirk…ôtl…ôri, x…ôb…ôr t…ô≈ükilatlarƒ± v…ô agentlikl…ôr √º√ß√ºn m√ºk…ômm…ôl. Pe≈ü…ôkar i≈ü axƒ±nlarƒ± √º√ß√ºn qabaqcƒ±l x√ºsusiyy…ôtl…ôr, webhooklar v…ô x√ºsusi d…ôst…ôk daxildir.',
          billing: 'Tezlikl…ô'
        },
        'Enterprise': {
          name: 'Korporativ',
          description: 'B√∂y√ºk t…ô≈ükilatlar √º√ß√ºn n…ôz…ôrd…ô tutulub. Korporativ ehtiyaclar √º√ß√ºn x√ºsusi inteqrasiyalar, SLA z…ôman…ôtl…ôri v…ô missiya-kritik media t…ôhlili √º√ß√ºn x√ºsusi d…ôst…ôk daxildir.',
          billing: 'Tezlikl…ô'
        }
      };
      
      const plansHTML = plans.map(plan => {
        const isFree = plan.isFree;
        const isComingSoon = plan.isComingSoon;
        const cardClass = isComingSoon ? 'plan-card coming-soon' : 'plan-card';
        
        // Get translation or use original
        const translation = planTranslations[plan.name] || {
          name: plan.name,
          description: plan.description,
          billing: plan.billing
        };
        
        // Fix pricing display for free plans
        const displayPrice = isFree ? 'Pulsuz' : `$${plan.priceDollars}`;
        const displayBilling = isFree ? 'H…ômi≈ü…ôlik pulsuz' : (translation.billing || plan.billing);
        
        return `
          <div class="${cardClass}">
            <div class="plan-header">
              <h3 class="plan-name">${translation.name}</h3>
              <div class="plan-price ${isFree ? 'free' : ''}">
                ${displayPrice}
                ${displayBilling ? `<small style="display: block; font-size: 0.7rem; color: var(--muted);">${displayBilling}</small>` : ''}
              </div>
            </div>
            
            <p class="plan-description">${translation.description}</p>
            
            <ul class="plan-features">
              ${plan.features.map(feature => `<li>${feature}</li>`).join('')}
            </ul>
            
            <div class="plan-limits">
              <h4>ƒ∞stifad…ô limitl…ôri</h4>
              <div class="limit-item">
                <span>Ayda sorƒüu sayƒ±</span>
                <span class="limit-value ${plan.maxRequestsPerMonth === -1 ? 'unlimited' : ''}">
                  ${plan.maxRequestsPerMonth === -1 ? 'Limitsiz' : plan.maxRequestsPerMonth.toLocaleString()}
                </span>
              </div>
              <div class="limit-item">
                <span>Aylƒ±q x…ôrc</span>
                <span class="limit-value ${plan.maxCostPerMonth === -1 ? 'unlimited' : ''}">
                  ${isFree ? 'Pulsuz' : (plan.maxCostPerMonth === -1 ? 'Limitsiz' : `$${plan.maxCostPerMonth.toFixed(2)}`)}
                </span>
              </div>
              <div class="limit-item">
                <span>Bir sorƒüu √º√ß√ºn x…ôrc</span>
                <span class="limit-value">${isFree ? 'Pulsuz' : `$${plan.costPerRequest.toFixed(4)}`}</span>
              </div>
            </div>
          </div>
        `;
      }).join('');
      
      container.innerHTML = plansHTML;
    }

    async function loadSubscription() {
      const resultEl = document.getElementById('billing-result');
      const subscriptionUI = document.getElementById('subscription-ui');
      const subscriptionContainer = document.getElementById('subscription-container');
      const jsonEl = document.getElementById('billing-json');
      const contentEl = document.getElementById('billing-result-content');
      
      resultEl.classList.remove('hidden');
      subscriptionUI.classList.remove('hidden');
      subscriptionContainer.innerHTML = '<div class="empty-state"><h4>Abun…ôlik y√ºkl…ônir...</h4><p>Abun…ôlik m…ôlumatlarƒ±nƒ±zƒ± g…ôtiririk, z…ôhm…ôt olmasa g√∂zl…ôyin.</p></div>';
      
      try {
        const response = await fetch('/api/billing/subscription');
        const data = await response.json();
        
        if (response.ok && data.success) {
          renderSubscriptionUI(data.subscription);
          
          // JSON b√∂lm…ôsind…ô xam m…ôlumatƒ± da g√∂st…ôr
          const result = {
            endpoint: '/api/billing/subscription',
            status: response.status,
            statusText: response.statusText,
            data: data,
            timestamp: new Date().toISOString()
          };
          
          contentEl.textContent = JSON.stringify(result, null, 2);
          contentEl.className = 'success';
          jsonEl.classList.remove('hidden');
        } else {
          throw new Error(data.message || 'Abun…ôliyi y√ºkl…ôm…ôk m√ºmk√ºn olmadƒ±');
        }
      } catch (error) {
        subscriptionContainer.innerHTML = `
          <div class="empty-state">
            <h4>Abun…ôlik y√ºkl…ôn…ôrk…ôn s…ôhv</h4>
            <p>${error.message}</p>
          </div>
        `;
        
        const result = {
          endpoint: '/api/billing/subscription',
          error: error.message,
          timestamp: new Date().toISOString()
        };
        
        contentEl.textContent = JSON.stringify(result, null, 2);
        contentEl.className = 'error';
        jsonEl.classList.remove('hidden');
      }
    }
    
    function renderSubscriptionUI(subscription) {
      const container = document.getElementById('subscription-container');
      
      if (!subscription) {
        container.innerHTML = '<div class="empty-state"><h4>Abun…ôlik yoxdur</h4><p>Hazƒ±rda pulsuz plandasƒ±nƒ±z.</p></div>';
        return;
      }
      
      const statusClass = subscription.status === 'active' ? 'active' : 'canceled';
      const statusText = subscription.status === 'active' ? 'Aktiv' : 'L…ôƒüv edilib';

      container.innerHTML = `
        <div class="subscription-card">
          <div class="subscription-header">
            <h3 class="subscription-plan">${subscription.planName || 'Pulsuz plan'}</h3>
            <span class="subscription-status ${statusClass}">${statusText}</span>
          </div>

          <div class="subscription-details">
            <div class="subscription-detail">
              <h5>Plan</h5>
              <p>${subscription.planName || 'Pulsuz'}</p>
            </div>
            <div class="subscription-detail">
              <h5>Status</h5>
              <p>${subscription.status || 'Aktiv'}</p>
            </div>
            <div class="subscription-detail">
              <h5>Qiym…ôt</h5>
              <p>${subscription.price ? `$${subscription.price}` : 'Pulsuz'}</p>
            </div>
            <div class="subscription-detail">
              <h5>N√∂vb…ôti √∂d…ôni≈ü</h5>
              <p>${subscription.currentPeriodEnd ? new Date(subscription.currentPeriodEnd * 1000).toLocaleDateString() : 'N/A'}</p>
            </div>
          </div>
        </div>
      `;
    }

    async function openBillingPortal() {
      const resultEl = document.getElementById('billing-result');
      const contentEl = document.getElementById('billing-result-content');
      
      resultEl.classList.remove('hidden');
      contentEl.textContent = '√ñd…ôni≈ü portalƒ± sessiyasƒ± yaradƒ±lƒ±r...';
      
      try {
        const response = await fetch('/api/billing/portal', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            returnUrl: window.location.href
          })
        });
        
        const data = await response.json();
        
        if (response.ok && data.url) {
          // √ñd…ôni≈ü portalƒ±nƒ± yeni v…ôr…ôqd…ô a√ß
          window.open(data.url, '_blank');
          
          const result = {
            endpoint: '/api/billing/portal',
            status: response.status,
            statusText: response.statusText,
            data: data,
            action: '√ñd…ôni≈ü portalƒ± yeni v…ôr…ôqd…ô a√ßƒ±ldƒ±',
            timestamp: new Date().toISOString()
          };
          
          contentEl.textContent = JSON.stringify(result, null, 2);
          contentEl.className = 'success';
        } else {
          const result = {
            endpoint: '/api/billing/portal',
            status: response.status,
            statusText: response.statusText,
            data: data,
            timestamp: new Date().toISOString()
          };
          
          contentEl.textContent = JSON.stringify(result, null, 2);
          contentEl.className = 'error';
        }
      } catch (error) {
        const result = {
          endpoint: '/api/billing/portal',
          error: error.message,
          timestamp: new Date().toISOString()
        };
        
        contentEl.textContent = JSON.stringify(result, null, 2);
        contentEl.className = 'error';
      }
    }

    // Checkout funksiyasƒ±nƒ± sƒ±na
    async function testCheckout() {
      const resultEl = document.getElementById('billing-result');
      const contentEl = document.getElementById('billing-result-content');
      
      resultEl.classList.remove('hidden');
      contentEl.textContent = 'Checkout sessiyasƒ± yaradƒ±lƒ±r...';
      
      try {
        const response = await fetch('/api/billing/checkout', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            planId: 'basic',
            successUrl: window.location.href + '?success=true',
            cancelUrl: window.location.href + '?canceled=true'
          })
        });
        
        const data = await response.json();
        
        const result = {
          endpoint: '/api/billing/checkout',
          status: response.status,
          statusText: response.statusText,
          data: data,
          timestamp: new Date().toISOString()
        };
        
        contentEl.textContent = JSON.stringify(result, null, 2);
        
        if (response.ok && data.url) {
          contentEl.className = 'success';
          // ƒ∞st…ôy…ô g√∂r…ô checkout-u yeni v…ôr…ôqd…ô a√ß
          if (confirm('Checkout sessiyasƒ± yaradƒ±ldƒ±! Stripe checkout-u yeni v…ôr…ôqd…ô a√ßmaq ist…ôyirsiniz?')) {
            window.open(data.url, '_blank');
          }
        } else {
          contentEl.className = 'error';
        }
      } catch (error) {
        const result = {
          endpoint: '/api/billing/checkout',
          error: error.message,
          timestamp: new Date().toISOString()
        };
        
        contentEl.textContent = JSON.stringify(result, null, 2);
        contentEl.className = 'error';
      }
    }

    // Admin panel JavaScript-i
    class AdminPanel {
      constructor() {
        this.currentUser = null;
        this.init();
      }

      init() {
        this.checkAuthStatus();
        this.bindEvents();
      }

      async checkAuthStatus() {
        try {
          const response = await fetch('/api/auth/me');
          if (response.ok) {
            this.currentUser = await response.json();
            this.updateUserStatus();
          } else {
            this.currentUser = null;
            this.updateUserStatus();
          }
        } catch (error) {
          console.error('Auth check failed:', error);
          this.currentUser = null;
          this.updateUserStatus();
        }
      }

      updateUserStatus() {
        const statusEl = document.getElementById('user-status');
        const userInfoEl = document.getElementById('user-info');
        const logoutBtn = document.getElementById('logout-btn');
        const loginSection = document.getElementById('login-section');
        const registerSection = document.getElementById('register-section');

        if (this.currentUser) {
          statusEl.innerHTML = '<div class="status-indicator status-online"></div><span>Daxil olundu</span>';
          userInfoEl.classList.remove('hidden');
          document.getElementById('user-name').textContent = this.currentUser.email;
          document.getElementById('user-email').textContent = this.currentUser.email;
          document.getElementById('user-plan').textContent = `Plan: ${this.currentUser.plan}`;
          logoutBtn.classList.remove('hidden');
          loginSection.style.display = 'none';
          registerSection.style.display = 'none';
          // Hesaba daxil olunduqda API a√ßarlarƒ±nƒ± y√ºkl…ô
          this.loadApiKeys();
        } else {
          statusEl.innerHTML = '<div class="status-indicator status-offline"></div><span>Hesaba daxil olunmayƒ±b</span>';
          userInfoEl.classList.add('hidden');
          logoutBtn.classList.add('hidden');
          loginSection.style.display = 'block';
          registerSection.style.display = 'block';
          // Daxil olunmadƒ±qda API a√ßarlarƒ±nƒ± t…ômizl…ô
          document.getElementById('keys-container').innerHTML = '<p>API a√ßarlarƒ±nƒ± idar…ô etm…ôk √º√ß√ºn daxil olun.</p>';
        }
      }

      bindEvents() {
        // Giri≈ü formu
        document.getElementById('login-form').addEventListener('submit', (e) => {
          e.preventDefault();
          this.handleLogin();
        });

        // Qeydiyyat formu
        document.getElementById('register-form').addEventListener('submit', (e) => {
          e.preventDefault();
          this.handleRegister();
        });

        // √áƒ±xƒ±≈ü d√ºym…ôsi
        document.getElementById('logout-btn').addEventListener('click', () => {
          this.handleLogout();
        });

        // API a√ßarƒ±nƒ±n idar…ô edilm…ôsi
        document.getElementById('create-key-btn').addEventListener('click', () => {
          this.showCreateKeyForm();
        });

        document.getElementById('cancel-key-btn').addEventListener('click', () => {
          this.hideCreateKeyForm();
        });

        document.getElementById('submit-key-btn').addEventListener('click', () => {
          this.handleCreateKey();
        });

        document.getElementById('refresh-keys-btn').addEventListener('click', () => {
          this.loadApiKeys();
        });

        // T…ôhlil sƒ±naƒüƒ± d√ºym…ôsi
        document.getElementById('test-analyze-btn').addEventListener('click', () => {
          this.testAnalysis();
        });

        // ƒ∞stifad…ô izl…ôm…ô d√ºym…ôl…ôri
        document.getElementById('load-usage-btn').addEventListener('click', loadUsage);
        document.getElementById('load-limits-btn').addEventListener('click', loadLimits);
        document.getElementById('load-history-btn').addEventListener('click', loadHistory);

        // √ñd…ôni≈ü d√ºym…ôl…ôri
        document.getElementById('load-plans-btn').addEventListener('click', loadPlans);
        document.getElementById('load-subscription-btn').addEventListener('click', loadSubscription);
        document.getElementById('test-checkout-btn').addEventListener('click', testCheckout);
        document.getElementById('billing-portal-btn').addEventListener('click', openBillingPortal);
        document.getElementById('close-plans-btn').addEventListener('click', () => {
          document.getElementById('plans-ui').classList.add('hidden');
        });
      }

      async handleLogin() {
        const email = document.getElementById('login-email').value;
        const password = document.getElementById('login-password').value;

        try {
          const response = await fetch('/api/auth/login', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ email, password }),
          });

          if (response.ok) {
            this.currentUser = await response.json();
            this.updateUserStatus();
            this.showMessage('Giri≈ü uƒüurla tamamlandƒ±!', 'success');
            document.getElementById('login-form').reset();
          } else {
            const error = await response.json();
            this.showMessage(`Giri≈ü uƒüursuz oldu: ${error.message}`, 'danger');
          }
        } catch (error) {
          this.showMessage(`Giri≈ü zamanƒ± s…ôhv: ${error.message}`, 'danger');
        }
      }

      async handleRegister() {
        const email = document.getElementById('register-email').value;
        const password = document.getElementById('register-password').value;
        const registrationToken = document.getElementById('register-token').value;

        try {
          const response = await fetch('/api/auth/register', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ email, password, registrationToken }),
          });

          if (response.ok) {
            this.showMessage('Qeydiyyat uƒüurla tamamlandƒ±! ƒ∞ndi daxil ola bil…ôrsiniz.', 'success');
            document.getElementById('register-form').reset();
          } else {
            const error = await response.json();
            this.showMessage(`Qeydiyyat alƒ±nmadƒ±: ${error.message}`, 'danger');
          }
        } catch (error) {
          this.showMessage(`Qeydiyyat zamanƒ± s…ôhv: ${error.message}`, 'danger');
        }
      }

      async handleLogout() {
        try {
          await fetch('/api/auth/logout', { method: 'POST' });
          this.currentUser = null;
          this.updateUserStatus();
          this.showMessage('√áƒ±xƒ±≈ü uƒüurla tamamlandƒ±!', 'info');
        } catch (error) {
          this.showMessage(`√áƒ±xƒ±≈ü zamanƒ± s…ôhv: ${error.message}`, 'danger');
        }
      }

      async testAnalysis() {
        const url = document.getElementById('test-url').value;
        const modelType = document.getElementById('test-model').value;
        const apiKey = document.getElementById('test-api-key').value;

        if (!url) {
          this.showMessage('Z…ôhm…ôt olmasa sƒ±naq √º√ß√ºn URL daxil edin', 'danger');
          return;
        }

        const btn = document.getElementById('test-analyze-btn');
        const originalText = btn.textContent;
        btn.disabled = true;
        btn.textContent = 'T…ôhlil olunur...';

        try {
          const headers = {
            'Content-Type': 'application/json',
          };
          
          // ∆èg…ôr g√∂st…ôrilibs…ô API a√ßarƒ±nƒ± …ôlav…ô et
          if (apiKey) {
            headers['Authorization'] = `Bearer ${apiKey}`;
          }

          const response = await fetch('/api/analyze', {
            method: 'POST',
            headers,
            body: JSON.stringify({ url, modelType }),
          });

          const result = await response.json();
          
          if (response.ok) {
            document.getElementById('test-result').classList.remove('hidden');
            document.getElementById('test-result-content').textContent = JSON.stringify(result, null, 2);
            document.getElementById('test-result-content').className = 'success';
            this.showMessage('T…ôhlil uƒüurla ba≈üa √ßatdƒ±!', 'success');
          } else {
            document.getElementById('test-result').classList.remove('hidden');
            document.getElementById('test-result-content').textContent = JSON.stringify(result, null, 2);
            document.getElementById('test-result-content').className = 'error';
            this.showMessage(`T…ôhlil alƒ±nmadƒ±: ${result.message || 'Nam…ôlum s…ôhv'}`, 'danger');
          }
        } catch (error) {
          document.getElementById('test-result').classList.remove('hidden');
          document.getElementById('test-result-content').textContent = JSON.stringify({error: error.message}, null, 2);
          document.getElementById('test-result-content').className = 'error';
          this.showMessage(`T…ôhlil zamanƒ± s…ôhv: ${error.message}`, 'danger');
        } finally {
          btn.disabled = false;
          btn.textContent = originalText;
        }
      }

      // API a√ßarlarƒ±nƒ±n idar…ôetm…ô metodlarƒ±
      showCreateKeyForm() {
        document.getElementById('create-key-form').classList.remove('hidden');
        document.getElementById('key-name').focus();
      }

      hideCreateKeyForm() {
        document.getElementById('create-key-form').classList.add('hidden');
        document.getElementById('key-name').value = '';
        document.getElementById('key-permissions').value = 'analyze,get-analysis';
      }

      async handleCreateKey() {
        const name = document.getElementById('key-name').value.trim();
        const permissions = document.getElementById('key-permissions').value
          .split(',')
          .map(p => p.trim())
          .filter(p => p);

        if (!name) {
          this.showMessage('Z…ôhm…ôt olmasa a√ßarƒ±n adƒ±nƒ± daxil edin', 'danger');
          return;
        }

        try {
          const response = await fetch('/api/keys/create', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ name, permissions }),
          });

          const result = await response.json();
          
          if (response.ok) {
            this.showMessage('API a√ßarƒ± uƒüurla yaradƒ±ldƒ±!', 'success');
            this.hideCreateKeyForm();
            this.loadApiKeys();

            // Yeni a√ßarƒ± istifad…ô√ßiy…ô g√∂st…ôr
            this.showMessage(`Yeni API a√ßarƒ±: ${result.apiKey.key}`, 'info');
          } else {
            this.showMessage(`API a√ßarƒ± yaratmaq alƒ±nmadƒ±: ${result.message}`, 'danger');
          }
        } catch (error) {
          this.showMessage(`API a√ßarƒ± yaradƒ±lark…ôn s…ôhv: ${error.message}`, 'danger');
        }
      }

      async loadApiKeys() {
        if (!this.currentUser) return;

        try {
          const response = await fetch('/api/keys/list');
          const result = await response.json();

          if (response.ok) {
            this.displayApiKeys(result.apiKeys);
          } else {
            document.getElementById('keys-container').innerHTML = '<p>API a√ßarlarƒ± y√ºkl…ônm…ôdi.</p>';
          }
        } catch (error) {
          document.getElementById('keys-container').innerHTML = '<p>API a√ßarlarƒ± y√ºkl…ôn…ôrk…ôn s…ôhv ba≈ü verdi.</p>';
        }
      }

      displayApiKeys(keys) {
        const container = document.getElementById('keys-container');

        if (!keys || keys.length === 0) {
          container.innerHTML = '<p>API a√ßarƒ± tapƒ±lmadƒ±. Ba≈ülamaq √º√ß√ºn bir a√ßar yaradƒ±n.</p>';
          return;
        }

        const keysHtml = keys.map(key => `
          <div class="api-key-item">
            <div class="api-key-header">
              <h5>${key.name}</h5>
              <a class="radial-item" onclick="event.preventDefault(); window.adminPanel.revokeKey('${key.id}')" data-tooltip="L…ôƒüv et" aria-label="L…ôƒüv et" href="#">
                <svg class="icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                  <path d="M3 6h18M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2m3 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h14zM10 11v6M14 11v6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </a>
            </div>
            <div class="api-key-details">
              <strong>ID:</strong> ${key.id}<br>
              <strong>ƒ∞caz…ôl…ôr:</strong> ${key.permissions.join(', ')}<br>
              <strong>Yaradƒ±lƒ±b:</strong> ${new Date(key.createdAt).toLocaleString()}<br>
              <strong>Son istifad…ô:</strong> ${key.lastUsed ? new Date(key.lastUsed).toLocaleString() : 'He√ß vaxt'}<br>
              <strong>Status:</strong> ${key.isActive ? 'Aktiv' : 'Passiv'}
            </div>
          </div>
        `).join('');

        container.innerHTML = keysHtml;
      }

      async revokeKey(keyId) {
        if (!confirm('Bu API a√ßarƒ±nƒ± l…ôƒüv etm…ôk ist…ôdiyiniz…ô …ôminsiniz? Bu …ôm…ôliyyatƒ± geri qaytarmaq m√ºmk√ºn deyil.')) {
          return;
        }

        try {
          const response = await fetch(`/api/keys/${keyId}`, {
            method: 'DELETE',
          });

          const result = await response.json();
          
          if (response.ok) {
            this.showMessage('API a√ßarƒ± uƒüurla l…ôƒüv edildi!', 'success');
            this.loadApiKeys();
          } else {
            this.showMessage(`API a√ßarƒ±nƒ± l…ôƒüv etm…ôk alƒ±nmadƒ±: ${result.message}`, 'danger');
          }
        } catch (error) {
          this.showMessage(`API a√ßarƒ±nƒ± l…ôƒüv ed…ôrk…ôn s…ôhv: ${error.message}`, 'danger');
        }
      }

      showMessage(text, type) {
        const messagesEl = document.getElementById('messages');
        const alertEl = document.createElement('div');
        alertEl.className = `alert alert-${type}`;
        alertEl.textContent = text;
        messagesEl.appendChild(alertEl);

        setTimeout(() => {
          alertEl.remove();
        }, 5000);
      }
    }

    // DOM y√ºkl…ôndikd…ô admin panelini i≈ü…ô sal
    document.addEventListener('DOMContentLoaded', () => {
      window.adminPanel = new AdminPanel();
    });
  </script>

  <script src="/static/layout.js" defer></script>
</body>
</html>